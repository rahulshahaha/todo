(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{174:function(t,e,n){"use strict";n.r(e);var a=n(2),c=n.n(a),r=n(25),o=n.n(r),i=(n(81),n(13)),s=n(30);n(177),n(83),n(175);s.a.initializeApp({apiKey:"AIzaSyCSu3ggsS66Mo1OullwbFJIg9mibC9E9wY",authDomain:"todo-8303f.firebaseapp.com",projectId:"todo-8303f",storageBucket:"todo-8303f.appspot.com",messagingSenderId:"928128254937",appId:"1:928128254937:web:a3f32fafc7ca5ba6c40fc8"}),s.a.firestore();var l=s.a,u=function(){return l.auth().currentUser.uid},d=n(5),j=n(18),f=n.n(j),h=function(t){if(null===t)return 0;var e=f()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()));return f.a.unix(t.seconds).diff(e,"days")},p=function(t){if(null===t.expectedUpdate)return"bg-white";var e=f()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),n=f.a.unix(t.expectedUpdate.seconds);return n.isBefore(e)&&5!==t.actionType&&6!==t.actionType?"bg-red-600 text-white":!n.isSame(e)||1!==t.actionType&&4!==t.actionType?!n.isSame(e)||2!==t.actionType&&3!==t.actionType?1===t.actionType||4===t.actionType?"bg-purple-300":2===t.actionType||3===t.actionType?"bg-gray-400":"bg-white":"bg-gray-600 text-white":"bg-purple-700 text-white"},b=n(71),O=n(1),x=c.a.createContext(),m=function(t){var e=t.children,n=Object(a.useState)(null),c=Object(d.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(null),u=Object(d.a)(s,2),j=u[0],f=u[1],m=Object(a.useState)(null),v=Object(d.a)(m,2),g=v[0],y=v[1],w=Object(a.useState)(null),k=Object(d.a)(w,2),T=k[0],C=k[1],S=Object(a.useState)(null),N=Object(d.a)(S,2),D=N[0],I=N[1],F=Object(b.a)(l.auth()),A=Object(d.a)(F,1)[0];return Object(a.useEffect)((function(){var t=A?A.uid:null;l.firestore().collection("users").doc("/"+t).onSnapshot((function(t){console.log("pull user doc"),t.exists?f(JSON.parse(t.data().weights)):f(null)}))}),[A]),Object(a.useEffect)((function(){var t=T?T.id:null;l.firestore().collection("users/"+t+"/oneOffs").where("done","==",!1).onSnapshot((function(t){console.log("pull one offs");var e=[];t.docs.forEach((function(t){e.push(Object(i.a)(Object(i.a)({},t.data()),{},{id:t.id}))})),y(e)}))}),[T]),Object(a.useEffect)((function(){var t=A?A.uid:null;l.firestore().collection("users/"+t+"/items").where("deleted","==",!1).onSnapshot((function(t){console.log("pull items");var e=[];t.docs.forEach((function(t){e.push(function(t,e){if(e&&t){var n=e.importanceTypes.filter((function(e){return e.id===t.importance}))[0],a=e.itemTypes.filter((function(e){return e.id===t.actionType}))[0],c=h(t.expectedUpdate),r=t.expectedUpdate?Math.max(0,1*n.weight*a.weight-c*e.dayDrop):0,o=p(t);return Object(i.a)(Object(i.a)({},t),{},{importanceName:n.name,importanceWeight:n.weight,actionTypeName:a.name,actionTypeWeight:a.weight,daysTo:c,score:r,colorClass:o})}return t}(Object(i.a)(Object(i.a)({},t.data()),{},{id:t.id,score:0}),j))})),o(e)}))}),[j,A]),Object(a.useEffect)((function(){C(A?{id:A.uid}:null)}),[A]),Object(a.useEffect)((function(){var t=A?A.uid:null;l.firestore().collection("users/"+t+"/history").orderBy("date","asc").onSnapshot((function(t){console.log("pull history");var e=[];t.docs.forEach((function(t){e.push(Object(i.a)({},t.data()))})),e.length>0?I(e):I(null)}))}),[A]),Object(O.jsx)(x.Provider,{value:{items:r,oneOffs:g,weights:j,FBuser:A,user:T,history:D},children:e})},v=function(){return null!==Object(a.useContext)(x).user&&Object(O.jsx)("button",{className:"ml-10 mt-5 mb-10 btn",onClick:function(){!function(){var t=u();l.firestore().collection("users/"+u()+"/items").add({action:"",actionType:1,description:"",expectedUpdate:null,importance:1,name:"NewName",notes:"",userID:t,deleted:!1})}()},children:"Add Item"})},g=n(17),y=function(){var t=Object(a.useContext)(x).user,e=Object(a.useState)({email:"",pass:""}),n=Object(d.a)(e,2),c=n[0],r=n[1];if(t)return Object(O.jsx)("button",{onClick:function(t){l.auth().signOut()},className:"btn",children:"Logout"});var o=function(t){r(Object(i.a)(Object(i.a)({},c),{},Object(g.a)({},t.target.id,t.target.value)))};return Object(O.jsx)("div",{children:Object(O.jsxs)("form",{onSubmit:function(t){var e,n;t.preventDefault(),e=c.email,n=c.pass,l.auth().signInWithEmailAndPassword(e,n),r({email:"",pass:""})},children:[Object(O.jsx)("input",{onChange:o,value:c.email,id:"email",className:"formInput",type:"email"}),Object(O.jsx)("input",{onChange:o,value:c.pass,id:"pass",className:"formInput",type:"password"}),Object(O.jsx)("button",{className:"btn",type:"submit",children:"Login"})]})})},w=function(t){var e=t.importanceTypes,n=Object(a.useState)([]),c=Object(d.a)(n,2),r=c[0],o=c[1],s=function(t){for(var e=!1,n=r,a=0;a<n.length;a++)n[a].id===parseInt(t.target.id)&&(e=!0,n[a]={id:n[a].id,weight:t.target.value});e?o(n):n.push({id:parseInt(t.target.id),weight:t.target.value})};return Object(O.jsxs)("div",{children:[e&&e.map((function(t){return Object(O.jsxs)("div",{children:[Object(O.jsx)("p",{children:t.name}),Object(O.jsx)("input",{defaultValue:t.weight,id:t.id,onChange:s,className:"formInput"})]},t.id)})),Object(O.jsx)("button",{className:"btn",onClick:function(){!function(t){l.firestore().collection("users").doc(u()).get().then((function(e){for(var n=JSON.parse(e.data().weights),a=n.importanceTypes,c=0;c<t.length;c++)if(!isNaN(parseFloat(t[c].weight)))for(var r=0;r<a.length;r++)a[r].id===t[c].id&&(console.log("t"),a[r]=Object(i.a)(Object(i.a)({},a[r]),{},{weight:parseFloat(t[c].weight)}));n.importanceTypes=a,l.firestore().collection("users").doc(u()).update({weights:JSON.stringify(n)}).then((function(t){window.location.reload()}))}))}(r)},children:"Change"})]})},k=function(){var t=Object(a.useContext)(x).weights;return Object(O.jsx)("div",{className:"mx-10 mb-10",children:Object(O.jsx)("div",{children:t?Object(O.jsx)(w,{importanceTypes:t.importanceTypes}):null})})},T=n(75),C=n(76),S=Object(i.a)(Object(i.a)({},T),{},{tip:C.a}),N=function(){var t=Object(a.useContext)(x),e=t.history,n=t.user,c=null;if(e&&e.length>0){var r=[];e.forEach((function(t){r.push({x:f.a.unix(t.date.seconds).toDate(),y:t.score})})),c={lines:[{name:"Score History",data:r}],minY:0,xTicks:6,yTicks:10,dots:!1,dotSize:1.75}}var o=function(t){return t},i=function(t){return t};null!==c&&(o=function(t){return f()(t).format("MM/DD/YY")},i=function(t){return t.toFixed(2)});var s=Object(a.useRef)();return Object(a.useEffect)((function(){var t=10,e=20,n=35,a=20,r=S.select(s.current).attr("viewBox","0 0 ".concat(500," ").concat(200)).select(".chartArea").attr("height",200).attr("class","chartArea").attr("width",500).attr("transform","translate(".concat(n,",").concat(t,")"));r.selectAll("g").remove();var l=500-n-a,u=200-t-e,d=r.append("g").attr("transform","translate(-".concat(n,",-").concat(t,")"));if(d.selectAll("g").remove(),d.selectAll("path").remove(),c){var j=d.append("g").style("opacity",0).attr("transform","translate(".concat(n,",").concat(t,")")),f=j.append("line").attr("stroke","#aaa").attr("stroke-width",1).attr("stroke-dasharray",4),h=j.append("line").attr("stroke","#aaa").attr("stroke-width",1).attr("stroke-dasharray",4),p=r.append("g").attr("transform","translate(0,".concat(u,")")),b=r.append("g").attr("transform","translate(0, 0)"),O=S.line().x((function(t){return w(t.x)})).y((function(t){return y(t.y)})),x=0,m=0,v=new Date;c.lines.forEach((function(t){t.data.forEach((function(t){x=Math.max(t.x,x),m=Math.max(t.y,m),v=Math.min(t.x,v)}))}));var g=c.minY?c.minY:0,y=S.scaleLinear().range([0,u]).domain([m,g]),w=S.scaleTime().range([0,l]).domain([v,x]);c.lines.forEach((function(e){var a=S.tip().attr("class","tip card").html((function(t,e){var n=o(e.x),a=i(e.y),c="";return c+='<div class="name">'.concat(n,"</div>"),c+='<div class="cost">'.concat(a,"</div>")}));d.call(a);var r=d.append("path").attr("transform","translate(".concat(n,",").concat(t,")")),s=d.selectAll("circle."+e.name).data(e.data),l=c.dotSize?c.dotSize:3;s.exit().remove(),s.attr("r",l).attr("fill","black").attr("cx",(function(t){return w(t.x)})).attr("cy",(function(t){return y(t.y)})).attr("transform","translate(".concat(n,",").concat(t,")")).on("mouseover",a.show).on("mouseout",a.hide),s.enter().append("circle").attr("fill","black").attr("cx",(function(t){return w(t.x)})).attr("cy",(function(t){return y(t.y)})).attr("r",l).attr("transform","translate(".concat(n,",").concat(t,")")).attr("opacity",0).on("mouseover.tip",a.show).on("mouseover.lines",(function(t,e){f.attr("x1",w(e.x)).attr("x2",w(e.x)).attr("y1",y(e.y)).attr("y2",u),h.attr("x1",0).attr("x2",w(e.x)).attr("y1",y(e.y)).attr("y2",y(e.y)),j.style("opacity",1)})).on("mouseout.tip",a.hide).on("mouseout.lines",(function(t,e){j.style("opacity",0)})).transition().duration(2e3).attrTween("opacity",(function(t,n,a){return function(t){if(!1===c.dots)return 0;if(0===n)return 1;var a=e.data.length-1;return 1*n/a<=t?1:0}})).ease(S.easeLinear),r.data([e.data]).attr("fill","none").attr("stroke","black").attr("stroke-width",0).attr("d",O).style("opacity",.75);var p=r.node().getTotalLength();r.attr("stroke-dasharray",p+" "+p).attr("stroke-dashoffset",p).transition().ease(S.easeLinear).attr("stroke-dashoffset",0).attr("stroke-width",2).duration(2e3)}));var k=c.xTicks?c.xTicks:5,T=c.yTicks?c.yTicks:5,C=S.axisBottom(w).tickFormat((function(t){return o(t)})).ticks(k),N=S.axisLeft(y).tickFormat((function(t){return i(t)})).ticks(T);c.yTicks&&N.ticks(c.yTicks),p.call(C).attr("class","chartAxis"),b.call(N).attr("class","chartAxis")}}),[n,c]),Object(O.jsx)("div",{children:Object(O.jsx)("svg",{ref:s,children:Object(O.jsx)("g",{className:"chartArea"})})})},D=function(){var t=Object(a.useState)(""),e=Object(d.a)(t,2),n=e[0],c=e[1];return Object(O.jsx)("form",{onSubmit:function(t){t.preventDefault(),function(t){var e=u();l.firestore().collection("users/"+u()+"/oneOffs").add({name:t,done:!1,userID:e})}(n),c("")},children:Object(O.jsx)("input",{className:"formInput",value:n,onChange:function(t){c(t.target.value)}})})},I=function(t){var e=t.oneOff;return Object(O.jsxs)("div",{className:"flex",children:[Object(O.jsx)("input",{onChange:function(){var t;t=e.id,l.firestore().collection("users/"+u()+"/oneOffs").doc(t).update({done:!0})},type:"checkbox"}),Object(O.jsx)("p",{children:e.name})]})},F=function(){var t=Object(a.useContext)(x).oneOffs;return Object(O.jsx)("div",{className:"w-full",children:Object(O.jsxs)("div",{className:"m-auto w-48",children:[Object(O.jsx)("h1",{className:"text-lg underline",children:"One Off Items"}),t&&t.map((function(t){return Object(O.jsx)(I,{oneOff:t},t.id)})),Object(O.jsx)(D,{})]})})},A=n(23),E=function(t){var e=t.item,n=e.name,c=Object(a.useState)(0),r=Object(d.a)(c,2),o=r[0],i=r[1],s=Object(a.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(O.jsx)("td",{children:Object(O.jsx)(A.a,{onFocus:function(t){t.target.select()},className:"tableTextArea "+e.colorClass,autoFocus:!0,onChange:function(t){h(t.target.value)},onBlur:function(){f!==n&&function(t,e){l.firestore().collection("users/"+u()+"/items").doc(e).update({name:t})}(f,e.id),i(0)},value:f})}):Object(O.jsx)("td",{onClick:function(){i(1)},children:Object(O.jsx)("p",{children:n})})},M=function(t){var e=t.item,n=e.importance;return Object(O.jsx)("td",{children:Object(O.jsxs)("select",{className:e.colorClass,onChange:function(t){!function(t,e){l.firestore().collection("users/"+u()+"/items").doc(e).update({importance:parseInt(t)})}(t.target.value,e.id)},value:n,children:[Object(O.jsx)("option",{value:1,children:"High"}),Object(O.jsx)("option",{value:2,children:"Medium"}),Object(O.jsx)("option",{value:3,children:"Low"})]})})},U=function(t){var e=t.item,n=e.description,c=Object(a.useState)(0),r=Object(d.a)(c,2),o=r[0],i=r[1],s=Object(a.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(O.jsx)("td",{children:Object(O.jsx)(A.a,{onFocus:function(t){t.target.select()},className:"tableTextArea "+e.colorClass,autoFocus:!0,onChange:function(t){h(t.target.value)},onBlur:function(){var t,a;n!==f&&(t=f,a=e.id,l.firestore().collection("users/"+u()+"/items").doc(a).update({description:t})),i(0)},value:f})}):Object(O.jsx)("td",{onClick:function(){i(1)},children:n})},B=function(t){var e=t.item,n=e.actionType;return Object(O.jsx)("td",{children:Object(O.jsxs)("select",{className:e.colorClass,onChange:function(t){var n,a;n=t.target.value,a=e.id,l.firestore().collection("users/"+u()+"/items").doc(a).update({actionType:parseInt(n)})},value:n,children:[Object(O.jsx)("option",{value:1,children:"ToDo"}),Object(O.jsx)("option",{value:2,children:"Wait for Meeting"}),Object(O.jsx)("option",{value:3,children:"Wait for Response"}),Object(O.jsx)("option",{value:4,children:"Follow-up"}),Object(O.jsx)("option",{value:5,children:"Nothing yet"}),Object(O.jsx)("option",{value:6,children:"Fully done"})]})})},L=function(t){var e=t.item,n=e.action,c=Object(a.useState)(0),r=Object(d.a)(c,2),o=r[0],i=r[1],s=Object(a.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(O.jsx)("td",{children:Object(O.jsx)(A.a,{onFocus:function(t){t.target.select()},className:"tableTextArea "+e.colorClass,autoFocus:!0,onChange:function(t){h(t.target.value),t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px"},onBlur:function(){n!==f&&function(t,e){l.firestore().collection("users/"+u()+"/items").doc(e).update({action:t})}(f,e.id),i(0)},value:f})}):Object(O.jsx)("td",{onClick:function(){i(1)},children:n})},Y=n(72),J=n.n(Y),W=(n(88),function(t){var e=t.item,n=e.expectedUpdate?f.a.unix(e.expectedUpdate.seconds).toDate():null;return Object(O.jsx)("td",{children:Object(O.jsx)(J.a,{wrapperClassName:"mr-10",className:e.colorClass+" static",selected:n,onChange:function(t){var n,a;n=t,a=e.id,l.firestore().collection("users/"+u()+"/items").doc(a).update({expectedUpdate:n})}})})}),z=function(t){var e=t.itemID;return Object(O.jsx)("div",{children:Object(O.jsx)("svg",{onClick:function(t){!0===window.confirm("Are you sure you want to delete?")&&function(t){l.firestore().collection("users/"+u()+"/items").doc(t).update({deleted:!0})}(e)},className:"trashIcon hidden absolute right-0 w-5 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(O.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})},H=function(t){var e=t.item;return Object(O.jsxs)("tr",{className:e.colorClass,children:[Object(O.jsxs)("td",{className:"relative",children:[Object(O.jsx)(z,{itemID:e.id}),e.score.toFixed(2)]}),Object(O.jsx)(E,{item:e}),Object(O.jsx)(M,{item:e}),Object(O.jsx)(U,{item:e}),Object(O.jsx)(B,{item:e}),Object(O.jsx)(L,{item:e}),Object(O.jsx)(W,{item:e})]})},P=function(){var t=Object(a.useContext)(x).items,e=t?t.sort((function(t,e){return null===t.expectedUpdate?1:null===e.expectedUpdate?-1:e.score-t.score})):null;return Object(O.jsx)("div",{children:Object(O.jsxs)("table",{children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Score"}),Object(O.jsx)("th",{children:"Name"}),Object(O.jsx)("th",{children:"Importance"}),Object(O.jsx)("th",{children:"Description"}),Object(O.jsx)("th",{children:"Action Type"}),Object(O.jsx)("th",{children:"Action"}),Object(O.jsx)("th",{children:"Expected Update"})]})}),Object(O.jsx)("tbody",{children:e&&e.map((function(t){return Object(O.jsx)(H,{item:t},t.id)}))})]})})},R=function(){var t=Object(a.useContext)(x),e=t.items,n=t.oneOffs,c=t.weights,r=t.user,o=c?c.oneOff:0,i=Object(a.useState)(0),s=Object(d.a)(i,2),j=s[0],f=s[1];return Object(a.useEffect)((function(){var t=0,a=!1;if(e&&n){for(var c=0;c<e.length;c++)t+=e[c].score;t>0&&(a=!0),t+=n.length*o}t!==j&&e&&n&&a&&r&&(1===t&&console.log(e),function(t){var e=new Date;l.firestore().collection("users").doc(u()).get().then((function(n){n.data().currentScore!==t&&l.firestore().collection("users").doc(u()).update({currentScore:parseFloat(t)}).then((function(n){l.firestore().collection("users/"+u()+"/history").add({date:e,score:parseFloat(t)})}))}))}(t.toFixed(2))),f(t)}),[e,n,o,j,r]),Object(O.jsx)("div",{children:Object(O.jsx)("h1",{className:"text-center text-4xl my-5",children:j.toFixed(2)})})};var V=function(){return Object(O.jsx)(m,{children:Object(O.jsxs)("div",{className:"App",children:[Object(O.jsx)(y,{}),Object(O.jsx)(R,{}),Object(O.jsx)(F,{}),Object(O.jsx)(P,{}),Object(O.jsx)(v,{}),Object(O.jsx)(k,{}),Object(O.jsx)(N,{})]})})};o.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(V,{})}),document.getElementById("root"))},81:function(t,e,n){}},[[174,1,2]]]);
//# sourceMappingURL=main.4255119a.chunk.js.map