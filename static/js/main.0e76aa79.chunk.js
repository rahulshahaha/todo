(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{175:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(25),o=n.n(r),i=(n(82),n(13)),s=n(33);n(178),n(84),n(176);s.a.initializeApp({apiKey:"AIzaSyCSu3ggsS66Mo1OullwbFJIg9mibC9E9wY",authDomain:"todo-8303f.firebaseapp.com",projectId:"todo-8303f",storageBucket:"todo-8303f.appspot.com",messagingSenderId:"928128254937",appId:"1:928128254937:web:a3f32fafc7ca5ba6c40fc8"}),s.a.firestore();var l=s.a,u=function(){return l.auth().currentUser.uid},d=n(5),j=n(17),f=n.n(j),h=function(e){if(null===e)return 0;var t=f()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()));return f.a.unix(e.seconds).diff(t,"days")},p=function(e){if(null===e.expectedUpdate)return"bg-white";var t=f()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),n=f.a.unix(e.expectedUpdate.seconds);return n.isBefore(t)&&5!==e.actionType&&6!==e.actionType?"bg-red-600 text-white":!n.isSame(t)||1!==e.actionType&&4!==e.actionType?!n.isSame(t)||2!==e.actionType&&3!==e.actionType?1===e.actionType||4===e.actionType?"bg-purple-300":2===e.actionType||3===e.actionType?"bg-gray-400":"bg-white":"bg-gray-600 text-white":"bg-purple-700 text-white"},b=n(74),x=n(27),m=n(1),O=a.a.createContext(),v=function(e){var t=e.children,n=Object(b.a)(l.auth()),c=Object(d.a)(n,1)[0],a=c?c.uid:null,r=Object(x.a)(l.firestore().collection("users/"+a+"/oneOffs").where("done","==",!1),{idField:"id"}),o=Object(d.a)(r,1)[0],s=Object(x.b)(l.firestore().collection("users").doc("/"+a),{transform:function(e){return Object(i.a)({},JSON.parse(e.weights))}}),u=Object(d.a)(s,1)[0],j=Object(x.a)(l.firestore().collection("users/"+a+"/items").where("deleted","==",!1),{idField:"id",transform:function(e){return function(e,t){if(t&&e){var n=t.importanceTypes.filter((function(t){return t.id===e.importance}))[0],c=t.itemTypes.filter((function(t){return t.id===e.actionType}))[0],a=h(e.expectedUpdate),r=e.expectedUpdate?Math.max(0,1*n.weight*c.weight-a*t.dayDrop):0,o=p(e);return Object(i.a)(Object(i.a)({},e),{},{importanceName:n.name,importanceWeight:n.weight,actionTypeName:c.name,actionTypeWeight:c.weight,daysTo:a,score:r,colorClass:o})}return e}(Object(i.a)(Object(i.a)({},e),{},{score:0}),u)}}),f=Object(d.a)(j,1)[0],v=Object(x.a)(l.firestore().collection("users/"+a+"/history").orderBy("date","asc")),g=Object(d.a)(v,1)[0];return Object(m.jsx)(O.Provider,{value:{items:f,oneOffs:o,weights:u,FBuser:c,history:g},children:t})},g=function(){return null!==Object(c.useContext)(O).FBuser&&Object(m.jsx)("button",{className:"ml-10 mt-5 mb-10 btn",onClick:function(){!function(){var e=u();l.firestore().collection("users/"+u()+"/items").add({action:"",actionType:1,description:"",expectedUpdate:null,importance:1,name:"NewName",notes:"",userID:e,deleted:!1})}()},children:"Add Item"})},y=n(18),w=function(){var e=Object(c.useContext)(O).FBuser,t=Object(c.useState)({email:"",pass:""}),n=Object(d.a)(t,2),a=n[0],r=n[1];if(e)return Object(m.jsx)("button",{onClick:function(e){l.auth().signOut()},className:"btn",children:"Logout"});var o=function(e){r(Object(i.a)(Object(i.a)({},a),{},Object(y.a)({},e.target.id,e.target.value)))};return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:function(e){var t,n;e.preventDefault(),t=a.email,n=a.pass,l.auth().signInWithEmailAndPassword(t,n),r({email:"",pass:""})},children:[Object(m.jsx)("input",{onChange:o,value:a.email,id:"email",className:"formInput",type:"email"}),Object(m.jsx)("input",{onChange:o,value:a.pass,id:"pass",className:"formInput",type:"password"}),Object(m.jsx)("button",{className:"btn",type:"submit",children:"Login"})]})})},k=function(e){var t=e.importanceTypes,n=Object(c.useState)([]),a=Object(d.a)(n,2),r=a[0],o=a[1],s=function(e){for(var t=!1,n=r,c=0;c<n.length;c++)n[c].id===parseInt(e.target.id)&&(t=!0,n[c]={id:n[c].id,weight:e.target.value});t?o(n):n.push({id:parseInt(e.target.id),weight:e.target.value})};return Object(m.jsxs)("div",{children:[t&&t.map((function(e){return Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:e.name}),Object(m.jsx)("input",{defaultValue:e.weight,id:e.id,onChange:s,className:"formInput"})]},e.id)})),Object(m.jsx)("button",{className:"btn",onClick:function(){!function(e){l.firestore().collection("users").doc(u()).get().then((function(t){for(var n=JSON.parse(t.data().weights),c=n.importanceTypes,a=0;a<e.length;a++)if(!isNaN(parseFloat(e[a].weight)))for(var r=0;r<c.length;r++)c[r].id===e[a].id&&(console.log("t"),c[r]=Object(i.a)(Object(i.a)({},c[r]),{},{weight:parseFloat(e[a].weight)}));n.importanceTypes=c,l.firestore().collection("users").doc(u()).update({weights:JSON.stringify(n)}).then((function(e){window.location.reload()}))}))}(r)},children:"Change"})]})},C=function(){var e=Object(c.useContext)(O).weights;return Object(m.jsx)("div",{className:"mx-10 mb-10",children:Object(m.jsx)("div",{children:e?Object(m.jsx)(k,{importanceTypes:e.importanceTypes}):null})})},N=function(){var e=Object(c.useState)(""),t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(m.jsx)("form",{onSubmit:function(e){e.preventDefault(),function(e){var t=u();l.firestore().collection("users/"+u()+"/oneOffs").add({name:e,done:!1,userID:t})}(n),a("")},children:Object(m.jsx)("input",{className:"formInput",value:n,onChange:function(e){a(e.target.value)}})})},T=function(e){var t=e.oneOff;return Object(m.jsxs)("div",{className:"flex",children:[Object(m.jsx)("input",{onChange:function(){var e;e=t.id,l.firestore().collection("users/"+u()+"/oneOffs").doc(e).update({done:!0})},type:"checkbox"}),Object(m.jsx)("p",{children:t.name})]})},F=function(){var e=Object(c.useContext)(O).oneOffs;return Object(m.jsx)("div",{className:"w-full",children:Object(m.jsxs)("div",{className:"m-auto w-48",children:[Object(m.jsx)("h1",{className:"text-lg underline",children:"One Off Items"}),e&&e.map((function(e){return Object(m.jsx)(T,{oneOff:e},e.id)})),Object(m.jsx)(N,{})]})})},S=n(23),D=function(e){var t=e.item,n=t.name,a=Object(c.useState)(0),r=Object(d.a)(a,2),o=r[0],i=r[1],s=Object(c.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(m.jsx)("td",{children:Object(m.jsx)(S.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){h(e.target.value)},onBlur:function(){f!==n&&function(e,t){l.firestore().collection("users/"+u()+"/items").doc(t).update({name:e})}(f,t.id),i(0)},value:f})}):Object(m.jsx)("td",{onClick:function(){i(1)},children:Object(m.jsx)("p",{children:n})})},I=function(e){var t=e.item,n=t.importance;return Object(m.jsx)("td",{children:Object(m.jsxs)("select",{className:t.colorClass,onChange:function(e){!function(e,t){l.firestore().collection("users/"+u()+"/items").doc(t).update({importance:parseInt(e)})}(e.target.value,t.id)},value:n,children:[Object(m.jsx)("option",{value:1,children:"High"}),Object(m.jsx)("option",{value:2,children:"Medium"}),Object(m.jsx)("option",{value:3,children:"Low"})]})})},A=function(e){var t=e.item,n=t.description,a=Object(c.useState)(0),r=Object(d.a)(a,2),o=r[0],i=r[1],s=Object(c.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(m.jsx)("td",{children:Object(m.jsx)(S.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){h(e.target.value)},onBlur:function(){var e,c;n!==f&&(e=f,c=t.id,l.firestore().collection("users/"+u()+"/items").doc(c).update({description:e})),i(0)},value:f})}):Object(m.jsx)("td",{onClick:function(){i(1)},children:n})},M=function(e){var t=e.item,n=t.actionType;return Object(m.jsx)("td",{children:Object(m.jsxs)("select",{className:t.colorClass,onChange:function(e){var n,c;n=e.target.value,c=t.id,l.firestore().collection("users/"+u()+"/items").doc(c).update({actionType:parseInt(n)})},value:n,children:[Object(m.jsx)("option",{value:1,children:"ToDo"}),Object(m.jsx)("option",{value:2,children:"Wait for Meeting"}),Object(m.jsx)("option",{value:3,children:"Wait for Response"}),Object(m.jsx)("option",{value:4,children:"Follow-up"}),Object(m.jsx)("option",{value:5,children:"Nothing yet"}),Object(m.jsx)("option",{value:6,children:"Fully done"})]})})},B=function(e){var t=e.item,n=t.action,a=Object(c.useState)(0),r=Object(d.a)(a,2),o=r[0],i=r[1],s=Object(c.useState)(n),j=Object(d.a)(s,2),f=j[0],h=j[1];return 1===o?Object(m.jsx)("td",{children:Object(m.jsx)(S.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){h(e.target.value),e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onBlur:function(){n!==f&&function(e,t){l.firestore().collection("users/"+u()+"/items").doc(t).update({action:e})}(f,t.id),i(0)},value:f})}):Object(m.jsx)("td",{onClick:function(){i(1)},children:n})},E=n(75),L=n.n(E),U=(n(88),function(e){var t=e.item,n=t.expectedUpdate?f.a.unix(t.expectedUpdate.seconds).toDate():null;return Object(m.jsx)("td",{children:Object(m.jsx)(L.a,{wrapperClassName:"mr-10",className:t.colorClass+" static",selected:n,onChange:function(e){var n,c;n=e,c=t.id,l.firestore().collection("users/"+u()+"/items").doc(c).update({expectedUpdate:n})}})})}),W=function(e){var t=e.itemID;return Object(m.jsx)("div",{children:Object(m.jsx)("svg",{onClick:function(e){!0===window.confirm("Are you sure you want to delete?")&&function(e){l.firestore().collection("users/"+u()+"/items").doc(e).update({deleted:!0})}(t)},className:"trashIcon hidden absolute right-0 w-5 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})},z=function(e){var t=e.item;return Object(m.jsxs)("tr",{className:t.colorClass,children:[Object(m.jsxs)("td",{className:"relative",children:[Object(m.jsx)(W,{itemID:t.id}),t.score.toFixed(2)]}),Object(m.jsx)(D,{item:t}),Object(m.jsx)(I,{item:t}),Object(m.jsx)(A,{item:t}),Object(m.jsx)(M,{item:t}),Object(m.jsx)(B,{item:t}),Object(m.jsx)(U,{item:t})]})},J=function(){var e=Object(c.useContext)(O).items,t=e?e.sort((function(e,t){return null===e.expectedUpdate?1:null===t.expectedUpdate?-1:t.score-e.score})):null;return Object(m.jsx)("div",{children:Object(m.jsxs)("table",{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Score"}),Object(m.jsx)("th",{children:"Name"}),Object(m.jsx)("th",{children:"Importance"}),Object(m.jsx)("th",{children:"Description"}),Object(m.jsx)("th",{children:"Action Type"}),Object(m.jsx)("th",{children:"Action"}),Object(m.jsx)("th",{children:"Expected Update"})]})}),Object(m.jsx)("tbody",{children:t&&t.map((function(e){return Object(m.jsx)(z,{item:e},e.id)}))})]})})},Y=n(31),H=n(32),V=Object(i.a)(Object(i.a)({},Y),{},{tip:H.a}),P=function(e){var t=[];t.push(e[0]);for(var n=1;n<e.length;n++)e[n].score!==e[n-1].score&&t.push(e[n]);return t},R=function(e){var t=[];return e.forEach((function(e){t.push({x:f.a.unix(e.date.seconds).toDate(),y:e.score})})),{lines:[{name:"Score History",data:t}],minY:0,xTicks:6,yTicks:7,dots:!0,dotSize:2}},K=function(e){return f()(e).format("MM/DD/YY")},q=function(e){return e.toFixed(2)},G=function(e,t){var n=function(e){var t=0,n=null;return e.lines.forEach((function(e){e.data.forEach((function(e){t=Math.max(e.y,t),n=n?Math.min(e.y,n):e.y}))})),{max:t,min:n-=.1*(t-n)}}(e);return V.scaleLinear().range([0,t]).domain([n.max,n.min])},Q=function(e,t){var n=function(e){var t=new Date,n=0;return e.lines.forEach((function(e){e.data.forEach((function(e){n=Math.max(e.x,n),t=Math.min(e.x,t)}))})),{max:n,min:t}}(e);return V.scaleTime().range([0,t]).domain([n.min,n.max])},X=function(){return V.tip().attr("class","tip card").html((function(e,t){var n=K(t.x),c=q(t.y),a=function(e){return f()(e).format("h:mm a")}(t.x),r="";return r+='<div class="score">'.concat(c,"</div>"),r+='<div class="name">'.concat(n,"</div>"),r+='<div class="cost">'.concat(a,"</div>")}))},Z=Object(i.a)(Object(i.a)({},Y),{},{tip:H.a}),$=function(e){var t=e.chartClass,n=Object(c.useContext)(O),a=n.history,r=n.FBuser,o=null;o=function(e){return e&&e.length>0?R(P(e)):null}(a);var i=Object(c.useRef)();return Object(c.useEffect)((function(){var e=10,t=35,n=500-t-20,c=200-e-20,a=Z.select(i.current).attr("viewBox","0 0 ".concat(500," ").concat(200)).select(".chartArea").attr("height",200).attr("class","chartArea").attr("width",500).attr("transform","translate(".concat(t,",").concat(e,")"));a.selectAll("g").remove();var r=a.append("g").attr("transform","translate(-".concat(t,",-").concat(e,")"));if(r.selectAll("g").remove(),r.selectAll("path").remove(),o){var s=r.append("g").style("opacity",0).attr("transform","translate(".concat(t,",").concat(e,")")),l=s.append("line").attr("stroke","#aaa").attr("stroke-width",1).attr("stroke-dasharray",4),u=s.append("line").attr("stroke","#aaa").attr("stroke-width",1).attr("stroke-dasharray",4),d=a.append("g").attr("transform","translate(0,".concat(c,")")),j=a.append("g").attr("transform","translate(0, 0)"),f=Q(o,n),h=G(o,c),p=Z.line().x((function(e){return f(e.x)})).y((function(e){return h(e.y)}));o.lines.forEach((function(n){var a=X();r.call(a);var i=r.append("path").attr("transform","translate(".concat(t,",").concat(e,")")),d=r.selectAll("circle."+n.name).data(n.data),j=o.dotSize?o.dotSize:5;d.exit().remove(),d.attr("r",j).attr("fill","black").attr("cx",(function(e){return f(e.x)})).attr("cy",(function(e){return h(e.y)})).attr("transform","translate(".concat(t,",").concat(e,")")).on("mouseover",a.show).on("mouseout",a.hide),d.enter().append("circle").attr("fill","black").attr("cx",(function(e){return f(e.x)})).attr("cy",(function(e){return h(e.y)})).attr("r",j).attr("transform","translate(".concat(t,",").concat(e,")")).attr("opacity",1).on("mouseover.tip",a.show).on("mouseover.lines",(function(e,t){l.attr("x1",f(t.x)).attr("x2",f(t.x)).attr("y1",h(t.y)).attr("y2",c),u.attr("x1",0).attr("x2",f(t.x)).attr("y1",h(t.y)).attr("y2",h(t.y)),s.style("opacity",1)})).on("mouseout.tip",a.hide).on("mouseout.lines",(function(e,t){s.style("opacity",0)}));var b=i.node().getTotalLength();i.data([n.data]).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("d",p).style("opacity",.75).attr("stroke-dasharray",b+" "+b)}));var b=o.xTicks?o.xTicks:5,x=o.yTicks?o.yTicks:5,m=o?K:function(e){return e},O=o?q:function(e){return e},v=Z.axisBottom(f).tickFormat((function(e){return m(e)})).ticks(b),g=Z.axisLeft(h).tickFormat((function(e){return O(e)})).ticks(x);d.call(v).attr("class","chartAxis"),j.call(g).attr("class","chartAxis")}}),[r,o]),Object(m.jsx)("div",{className:"flex justify-center",children:Object(m.jsx)("div",{className:t+" w-1/2",children:Object(m.jsx)("svg",{ref:i,children:Object(m.jsx)("g",{className:"chartArea"})})})})},_=function(){var e=Object(c.useContext)(O),t=e.items,n=e.oneOffs,a=e.weights,r=e.FBuser,o=a?a.oneOff:0,i=Object(c.useState)(0),s=Object(d.a)(i,2),j=s[0],f=s[1],h=Object(c.useState)(!1),p=Object(d.a)(h,2),b=p[0],x=p[1],v=b?"block":"hidden";Object(c.useEffect)((function(){var e=0,c=!1;if(t&&n){for(var a=0;a<t.length;a++)e+=t[a].score;e>0&&(c=!0),e+=n.length*o}e!==j&&t&&n&&c&&r&&function(e){var t=new Date;l.firestore().collection("users").doc(u()).get().then((function(n){n.data().currentScore.toFixed(2)!==e.toFixed(2)&&(console.log("log history. current:",n.data().currentScore,"new",e),l.firestore().collection("users").doc(u()).update({currentScore:parseFloat(e.toFixed(2))}).then((function(n){l.firestore().collection("users/"+u()+"/history").add({date:t,score:parseFloat(e.toFixed(2))})})))}))}(e),f(e)}),[t,n,o,j,r]);return Object(m.jsxs)("div",{className:"my-5",children:[Object(m.jsxs)("div",{className:"flex justify-center space-x-1",children:[Object(m.jsx)("h1",{className:"text-center text-4xl scoreLabel",children:j.toFixed(2)}),Object(m.jsx)("svg",{onClick:function(e){x(!b)},className:"w-5 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(m.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})]}),Object(m.jsx)($,{chartClass:v})]})};var ee=function(){return Object(m.jsx)(v,{children:Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(w,{}),Object(m.jsx)(_,{}),Object(m.jsx)(F,{}),Object(m.jsx)(J,{}),Object(m.jsx)(g,{}),Object(m.jsx)(C,{})]})})};o.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(ee,{})}),document.getElementById("root"))},82:function(e,t,n){}},[[175,1,2]]]);
//# sourceMappingURL=main.0e76aa79.chunk.js.map