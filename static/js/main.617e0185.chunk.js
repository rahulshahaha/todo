(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{168:function(e,t,n){"use strict";n.r(t);var c=n(2),i=n.n(c),a=n(22),s=n.n(a),o=(n(76),n(14)),r=n(27);n(171),n(78),n(169);r.a.initializeApp({apiKey:"AIzaSyCSu3ggsS66Mo1OullwbFJIg9mibC9E9wY",authDomain:"todo-8303f.firebaseapp.com",projectId:"todo-8303f",storageBucket:"todo-8303f.appspot.com",messagingSenderId:"928128254937",appId:"1:928128254937:web:a3f32fafc7ca5ba6c40fc8"}),r.a.firestore();var u=r.a,l=function(){return u.auth().currentUser.uid},d=n(9),j=n(16),b=n.n(j),f=function(e){if(null===e)return 0;var t=b()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()));return b.a.unix(e.seconds).diff(t,"days")},p=function(e){if(null===e.expectedUpdate)return"bg-white";var t=b()(new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())),n=b.a.unix(e.expectedUpdate.seconds);return n.isBefore(t)&&5!==e.actionType&&6!==e.actionType?"bg-red-600 text-white":!n.isSame(t)||1!==e.actionType&&4!==e.actionType?!n.isSame(t)||2!==e.actionType&&3!==e.actionType?1===e.actionType||4===e.actionType?"bg-purple-300":2===e.actionType||3===e.actionType?"bg-gray-400":"bg-white":"bg-gray-600 text-white":"bg-purple-700 text-white"},O=n(68),h=n(1),x=i.a.createContext(),m=function(e){var t=e.children,n=Object(c.useState)(null),i=Object(d.a)(n,2),a=i[0],s=i[1],r=Object(c.useState)(null),l=Object(d.a)(r,2),j=l[0],b=l[1],m=Object(c.useState)(null),g=Object(d.a)(m,2),v=g[0],w=g[1],y=Object(c.useState)(null),C=Object(d.a)(y,2),N=C[0],S=C[1],T=Object(O.a)(u.auth()),I=Object(d.a)(T,1)[0];return Object(c.useEffect)((function(){var e=N?N.id:null,t=u.firestore().collection("users").doc("/"+e).onSnapshot((function(e){e.exists?b(JSON.parse(e.data().weights)):b(null)}));return function(){t()}}),[N]),Object(c.useEffect)((function(){var e=N?N.id:null,t=u.firestore().collection("users/"+e+"/oneOffs").where("done","==",!1).onSnapshot((function(e){var t=[];e.docs.forEach((function(e){t.push(Object(o.a)(Object(o.a)({},e.data()),{},{id:e.id}))})),w(t)}));return function(){t()}}),[N]),Object(c.useEffect)((function(){var e=N?N.id:null,t=u.firestore().collection("users/"+e+"/items").where("deleted","==",!1).onSnapshot((function(e){var t=[];e.docs.forEach((function(e){t.push(function(e,t){if(t&&e){var n=t.importanceTypes.filter((function(t){return t.id===e.importance}))[0],c=t.itemTypes.filter((function(t){return t.id===e.actionType}))[0],i=f(e.expectedUpdate),a=e.expectedUpdate?Math.max(0,1*n.weight*c.weight-i*t.dayDrop):0,s=p(e);return Object(o.a)(Object(o.a)({},e),{},{importanceName:n.name,importanceWeight:n.weight,actionTypeName:c.name,actionTypeWeight:c.weight,daysTo:i,score:a,colorClass:s})}return e}(Object(o.a)(Object(o.a)({},e.data()),{},{id:e.id,score:0}),j))})),s(t)}));return function(){t()}}),[j,N]),Object(c.useEffect)((function(){S(I?{id:I.uid}:null)}),[I]),Object(h.jsx)(x.Provider,{value:{items:a,oneOffs:v,weights:j,FBuser:I,user:N},children:t})},g=function(){return null!==Object(c.useContext)(x).user&&Object(h.jsx)("button",{className:"ml-10 mt-5 mb-10 btn",onClick:function(){!function(){var e=l();u.firestore().collection("users/"+l()+"/items").add({action:"",actionType:1,description:"",expectedUpdate:null,importance:1,name:"NewName",notes:"",userID:e,deleted:!1})}()},children:"Add Item"})},v=n(26),w=function(){var e=Object(c.useContext)(x).user,t=Object(c.useState)({email:"",pass:""}),n=Object(d.a)(t,2),i=n[0],a=n[1];if(e)return Object(h.jsx)("button",{onClick:function(e){u.auth().signOut()},className:"btn",children:"Logout"});var s=function(e){a(Object(o.a)(Object(o.a)({},i),{},Object(v.a)({},e.target.id,e.target.value)))};return Object(h.jsx)("div",{children:Object(h.jsxs)("form",{onSubmit:function(e){var t,n;e.preventDefault(),t=i.email,n=i.pass,u.auth().signInWithEmailAndPassword(t,n),a({email:"",pass:""})},children:[Object(h.jsx)("input",{onChange:s,value:i.email,id:"email",className:"formInput",type:"email"}),Object(h.jsx)("input",{onChange:s,value:i.pass,id:"pass",className:"formInput",type:"password"}),Object(h.jsx)("button",{className:"btn",type:"submit",children:"Login"})]})})},y=function(e){var t=e.importanceTypes,n=Object(c.useState)([]),i=Object(d.a)(n,2),a=i[0],s=i[1],r=function(e){for(var t=!1,n=a,c=0;c<n.length;c++)n[c].id===parseInt(e.target.id)&&(t=!0,n[c]={id:n[c].id,weight:e.target.value});t?s(n):n.push({id:parseInt(e.target.id),weight:e.target.value})};return Object(h.jsxs)("div",{children:[t&&t.map((function(e){return Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:e.name}),Object(h.jsx)("input",{defaultValue:e.weight,id:e.id,onChange:r,className:"formInput"})]},e.id)})),Object(h.jsx)("button",{className:"btn",onClick:function(){!function(e){u.firestore().collection("users").doc(l()).get().then((function(t){for(var n=JSON.parse(t.data().weights),c=n.importanceTypes,i=0;i<e.length;i++)if(!isNaN(parseFloat(e[i].weight)))for(var a=0;a<c.length;a++)c[a].id===e[i].id&&(console.log("t"),c[a]=Object(o.a)(Object(o.a)({},c[a]),{},{weight:parseFloat(e[i].weight)}));n.importanceTypes=c,u.firestore().collection("users").doc(l()).update({weights:JSON.stringify(n)}).then((function(e){window.location.reload()}))}))}(a)},children:"Change"})]})},C=function(){var e=Object(c.useContext)(x).weights;return Object(h.jsx)("div",{className:"mx-10 mb-10",children:Object(h.jsx)("div",{children:e?Object(h.jsx)(y,{importanceTypes:e.importanceTypes}):null})})},N=function(){var e=Object(c.useState)(""),t=Object(d.a)(e,2),n=t[0],i=t[1];return Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault(),function(e){var t=l();u.firestore().collection("users/"+l()+"/oneOffs").add({name:e,done:!1,userID:t})}(n),i("")},children:Object(h.jsx)("input",{className:"formInput",value:n,onChange:function(e){i(e.target.value)}})})},S=function(e){var t=e.oneOff;return Object(h.jsxs)("div",{className:"flex",children:[Object(h.jsx)("input",{onChange:function(){var e;e=t.id,u.firestore().collection("users/"+l()+"/oneOffs").doc(e).update({done:!0})},type:"checkbox"}),Object(h.jsx)("p",{children:t.name})]})},T=function(){var e=Object(c.useContext)(x).oneOffs;return Object(h.jsx)("div",{className:"w-full",children:Object(h.jsxs)("div",{className:"m-auto w-48",children:[Object(h.jsx)("h1",{className:"text-lg underline",children:"One Off Items"}),e&&e.map((function(e){return Object(h.jsx)(S,{oneOff:e},e.id)})),Object(h.jsx)(N,{})]})})},I=n(20),D=function(e){var t=e.item,n=t.name,i=Object(c.useState)(0),a=Object(d.a)(i,2),s=a[0],o=a[1],r=Object(c.useState)(n),j=Object(d.a)(r,2),b=j[0],f=j[1];return 1===s?Object(h.jsx)("td",{children:Object(h.jsx)(I.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){f(e.target.value)},onBlur:function(){b!==n&&function(e,t){u.firestore().collection("users/"+l()+"/items").doc(t).update({name:e})}(b,t.id),o(0)},value:b})}):Object(h.jsx)("td",{onClick:function(){o(1)},children:Object(h.jsx)("p",{children:n})})},F=function(e){var t=e.item,n=t.importance;return Object(h.jsx)("td",{children:Object(h.jsxs)("select",{className:t.colorClass,onChange:function(e){!function(e,t){u.firestore().collection("users/"+l()+"/items").doc(t).update({importance:parseInt(e)})}(e.target.value,t.id)},value:n,children:[Object(h.jsx)("option",{value:1,children:"High"}),Object(h.jsx)("option",{value:2,children:"Medium"}),Object(h.jsx)("option",{value:3,children:"Low"})]})})},k=function(e){var t=e.item,n=t.description,i=Object(c.useState)(0),a=Object(d.a)(i,2),s=a[0],o=a[1],r=Object(c.useState)(n),j=Object(d.a)(r,2),b=j[0],f=j[1];return 1===s?Object(h.jsx)("td",{children:Object(h.jsx)(I.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){f(e.target.value)},onBlur:function(){var e,c;n!==b&&(e=b,c=t.id,u.firestore().collection("users/"+l()+"/items").doc(c).update({description:e})),o(0)},value:b})}):Object(h.jsx)("td",{onClick:function(){o(1)},children:n})},A=function(e){var t=e.item,n=t.actionType;return Object(h.jsx)("td",{children:Object(h.jsxs)("select",{className:t.colorClass,onChange:function(e){var n,c;n=e.target.value,c=t.id,u.firestore().collection("users/"+l()+"/items").doc(c).update({actionType:parseInt(n)})},value:n,children:[Object(h.jsx)("option",{value:1,children:"ToDo"}),Object(h.jsx)("option",{value:2,children:"Wait for Meeting"}),Object(h.jsx)("option",{value:3,children:"Wait for Response"}),Object(h.jsx)("option",{value:4,children:"Follow-up"}),Object(h.jsx)("option",{value:5,children:"Nothing yet"}),Object(h.jsx)("option",{value:6,children:"Fully done"})]})})},U=function(e){var t=e.item,n=t.action,i=Object(c.useState)(0),a=Object(d.a)(i,2),s=a[0],o=a[1],r=Object(c.useState)(n),j=Object(d.a)(r,2),b=j[0],f=j[1];return 1===s?Object(h.jsx)("td",{children:Object(h.jsx)(I.a,{onFocus:function(e){e.target.select()},className:"tableTextArea "+t.colorClass,autoFocus:!0,onChange:function(e){f(e.target.value),e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px"},onBlur:function(){n!==b&&function(e,t){u.firestore().collection("users/"+l()+"/items").doc(t).update({action:e})}(b,t.id),o(0)},value:b})}):Object(h.jsx)("td",{onClick:function(){o(1)},children:n})},E=n(69),M=n.n(E),B=(n(82),function(e){var t=e.item,n=t.expectedUpdate?b.a.unix(t.expectedUpdate.seconds).toDate():null;return Object(h.jsx)("td",{children:Object(h.jsx)(M.a,{wrapperClassName:"mr-10",className:t.colorClass+" static",selected:n,onChange:function(e){var n,c;n=e,c=t.id,u.firestore().collection("users/"+l()+"/items").doc(c).update({expectedUpdate:n})}})})}),J=function(e){var t=e.itemID;return Object(h.jsx)("div",{children:Object(h.jsx)("svg",{onClick:function(e){!0===window.confirm("Are you sure you want to delete?")&&function(e){u.firestore().collection("users/"+l()+"/items").doc(e).update({deleted:!0})}(t)},className:"trashIcon hidden absolute right-0 w-5 cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})},L=function(e){var t=e.item;return Object(h.jsxs)("tr",{className:t.colorClass,children:[Object(h.jsxs)("td",{className:"relative",children:[Object(h.jsx)(J,{itemID:t.id}),t.score.toFixed(2)]}),Object(h.jsx)(D,{item:t}),Object(h.jsx)(F,{item:t}),Object(h.jsx)(k,{item:t}),Object(h.jsx)(A,{item:t}),Object(h.jsx)(U,{item:t}),Object(h.jsx)(B,{item:t})]})},W=function(){var e=Object(c.useContext)(x).items,t=e?e.sort((function(e,t){return null===e.expectedUpdate?1:null===t.expectedUpdate?-1:t.score-e.score})):null;return Object(h.jsx)("div",{children:Object(h.jsxs)("table",{children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Score"}),Object(h.jsx)("th",{children:"Name"}),Object(h.jsx)("th",{children:"Importance"}),Object(h.jsx)("th",{children:"Description"}),Object(h.jsx)("th",{children:"Action Type"}),Object(h.jsx)("th",{children:"Action"}),Object(h.jsx)("th",{children:"Expected Update"})]})}),Object(h.jsx)("tbody",{children:t&&t.map((function(e){return Object(h.jsx)(L,{item:e},e.id)}))})]})})},H=function(){var e=Object(c.useContext)(x),t=e.items,n=e.oneOffs,i=e.weights,a=i?i.oneOff:0,s=Object(c.useState)(0),o=Object(d.a)(s,2),r=o[0],j=o[1];return Object(c.useEffect)((function(){var e=0;if(t)for(var c=0;c<t.length;c++)e+=t[c].score;n&&(e+=n.length*a),e!==r&&t&&n&&function(e){var t=new Date;u.firestore().collection("users/"+l()+"/history").add({date:t,score:e})}(e),j(e)}),[t,n,a,r]),Object(h.jsx)("div",{children:Object(h.jsx)("h1",{className:"text-center text-4xl my-5",children:r.toFixed(2)})})};var Y=function(){return Object(h.jsx)(m,{children:Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(w,{}),Object(h.jsx)(H,{}),Object(h.jsx)(T,{}),Object(h.jsx)(W,{}),Object(h.jsx)(g,{}),Object(h.jsx)(C,{})]})})};s.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(Y,{})}),document.getElementById("root"))},76:function(e,t,n){}},[[168,1,2]]]);
//# sourceMappingURL=main.617e0185.chunk.js.map